{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Introducci\u00f3n \u00b6 En contrucci\u00f3n En mayo de 2022 se celebr\u00f3 la octava edici\u00f3n del evento \u201cDesgranando Ciencia 8\u201d, organizado por la asociaci\u00f3n Hablando de Ciencia , en la que el Club Rob\u00f3tica Granada estuvo presente con dos charlas, una sobre la monitorizaci\u00f3n de la sala del Teatro Isabel la Cat\u00f3lica y otra sobre monitorizaci\u00f3n de ponentes, impartidas por Jos\u00e9 Mar\u00eda Fern\u00e1ndez Domenech y Manuel Hidalgo D\u00edaz. Video del evento , minutos 1:36:23 y 3:18:47 Este proyecto IoT es interesante tanto por la cantidad de magnitudes que se monitorizaron, las arquitecturas empleadas y los sistemas de comunicaci\u00f3n utilizados. Veamos a continuaci\u00f3n los dispositivos, comunicaciones, protocolos,... de la monotorizaci\u00f3n de los ponentes y sala. En contrucci\u00f3n","title":"Introducci\u00f3n"},{"location":"#introduccion","text":"En contrucci\u00f3n En mayo de 2022 se celebr\u00f3 la octava edici\u00f3n del evento \u201cDesgranando Ciencia 8\u201d, organizado por la asociaci\u00f3n Hablando de Ciencia , en la que el Club Rob\u00f3tica Granada estuvo presente con dos charlas, una sobre la monitorizaci\u00f3n de la sala del Teatro Isabel la Cat\u00f3lica y otra sobre monitorizaci\u00f3n de ponentes, impartidas por Jos\u00e9 Mar\u00eda Fern\u00e1ndez Domenech y Manuel Hidalgo D\u00edaz. Video del evento , minutos 1:36:23 y 3:18:47 Este proyecto IoT es interesante tanto por la cantidad de magnitudes que se monitorizaron, las arquitecturas empleadas y los sistemas de comunicaci\u00f3n utilizados. Veamos a continuaci\u00f3n los dispositivos, comunicaciones, protocolos,... de la monotorizaci\u00f3n de los ponentes y sala. En contrucci\u00f3n","title":"Introducci\u00f3n"},{"location":"about/","text":"Autores \u00b6 Jos\u00e9 M\u00aa Fern\u00e1ndez Ingeniero Tec. Telecomunicaciones Manuel Hidalgo - LeoBot Divulgador de Rob\u00f3tica Educativa y OpenSource","title":"Autores"},{"location":"about/#autores","text":"Jos\u00e9 M\u00aa Fern\u00e1ndez Ingeniero Tec. Telecomunicaciones Manuel Hidalgo - LeoBot Divulgador de Rob\u00f3tica Educativa y OpenSource","title":"Autores"},{"location":"imagenes/","text":"Galer\u00eda de im\u00e1genes y videos \u00b6","title":"Imagenes"},{"location":"imagenes/#galeria-de-imagenes-y-videos","text":"","title":"Galer\u00eda de im\u00e1genes y videos"},{"location":"monitorPonentes/ESP32STEAMakers/","text":"ESP32 STEAMakers \u00b6 La placa ESP32 STEAMakers controla los sensores para monitorizar a los ponentes. Microcontrolador de 32 bits ESP32-WROOM-32. Entradas y salidas digitales con alimentaci\u00f3n. Entradas anal\u00f3gicas. Puerto I2C. Conectividad Wifi y Bluetooth integrada en la propia placa. Z\u00f3calo tarjeta microSD para almacenamiento de datos. ... Placa ESP32 STEAMakers M\u00e1s detalle de la placa en los siguientes enlaces: Repositorio de Federico G. Coca Innova Didactic Para la programaci\u00f3n de la placa se utiliza el IDE Arduino instalando el software correspondiente a las placas ESP32 y seleccionando \"ESP32DevModule\". Programaci\u00f3n ESP32 STEAMakers","title":"ESP32STEAMakers"},{"location":"monitorPonentes/ESP32STEAMakers/#esp32-steamakers","text":"La placa ESP32 STEAMakers controla los sensores para monitorizar a los ponentes. Microcontrolador de 32 bits ESP32-WROOM-32. Entradas y salidas digitales con alimentaci\u00f3n. Entradas anal\u00f3gicas. Puerto I2C. Conectividad Wifi y Bluetooth integrada en la propia placa. Z\u00f3calo tarjeta microSD para almacenamiento de datos. ... Placa ESP32 STEAMakers M\u00e1s detalle de la placa en los siguientes enlaces: Repositorio de Federico G. Coca Innova Didactic Para la programaci\u00f3n de la placa se utiliza el IDE Arduino instalando el software correspondiente a las placas ESP32 y seleccionando \"ESP32DevModule\". Programaci\u00f3n ESP32 STEAMakers","title":"ESP32 STEAMakers"},{"location":"monitorPonentes/gsr/","text":"Sensor galv\u00e1nico GSR \u00b6 Un sensor galv\u00e1nico de respuesta de la piel (GSR) mide la resistencia el\u00e9ctrica de la piel a diferentes niveles de electricidad. Sensor GSR Estos sensores detectan cambios sutiles en la conductancia el\u00e9ctrica cuando est\u00e1s estresado o ansioso. Por ejemplo, los sensores GSR pueden detectar cambios en la conductancia el\u00e9ctrica de la piel que se producen cuando la piel est\u00e1 activa (p. ej., sudoraci\u00f3n). M\u00e1s informaci\u00f3n . wiki (Seed Studio) sensor GSR Esquema sensor GSR El sensor tiene 3 terminales alimentaci\u00f3n (Vcc, -) y una salida anal\u00f3gica. El c\u00f3digo de un programa de testeo para una placa Arduino. const int GSR=A0; int sensorValue=0; int gsr_average=0; void setup(){ Serial.begin(9600); } void loop(){ long sum=0; for(int i=0;i<10;i++) //suma de 10 medidas { sensorValue=analogRead(GSR); sum += sensorValue; delay(5); } gsr_average = sum/10; //media de las medidas Serial.println(gsr_average); }","title":"GSR (Sensor galv\u00e1nico)"},{"location":"monitorPonentes/gsr/#sensor-galvanico-gsr","text":"Un sensor galv\u00e1nico de respuesta de la piel (GSR) mide la resistencia el\u00e9ctrica de la piel a diferentes niveles de electricidad. Sensor GSR Estos sensores detectan cambios sutiles en la conductancia el\u00e9ctrica cuando est\u00e1s estresado o ansioso. Por ejemplo, los sensores GSR pueden detectar cambios en la conductancia el\u00e9ctrica de la piel que se producen cuando la piel est\u00e1 activa (p. ej., sudoraci\u00f3n). M\u00e1s informaci\u00f3n . wiki (Seed Studio) sensor GSR Esquema sensor GSR El sensor tiene 3 terminales alimentaci\u00f3n (Vcc, -) y una salida anal\u00f3gica. El c\u00f3digo de un programa de testeo para una placa Arduino. const int GSR=A0; int sensorValue=0; int gsr_average=0; void setup(){ Serial.begin(9600); } void loop(){ long sum=0; for(int i=0;i<10;i++) //suma de 10 medidas { sensorValue=analogRead(GSR); sum += sensorValue; delay(5); } gsr_average = sum/10; //media de las medidas Serial.println(gsr_average); }","title":"Sensor galv\u00e1nico GSR"},{"location":"monitorPonentes/introduccion/","text":"Monitorizaci\u00f3n Ponentes \u00b6 La monitorizaci\u00f3n de los ponentes se realiza con una placa controladora ESP32 STEAMakers, que permite la lectura anal\u00f3gica de un sensor de resistividad de piel y un pulsiox\u00edmetro con conexi\u00f3n I2C. Los datos recogidos por los sensores de transmiten v\u00eda bluetooth BLE, entre la ESP32 STEAMakers y la Raspberry Pi, a la aplicaci\u00f3n dise\u00f1ada en Node-RED para su tratamiento y almacenamiento en la base de datos SQLite. El dispositivo monitor de ponentes para ser autonomo se completa una alimentaci\u00f3n formada por un conversor DC/DC y una bater\u00eda lipo de 3.7V/1.100mAh.","title":"Introducci\u00f3n"},{"location":"monitorPonentes/introduccion/#monitorizacion-ponentes","text":"La monitorizaci\u00f3n de los ponentes se realiza con una placa controladora ESP32 STEAMakers, que permite la lectura anal\u00f3gica de un sensor de resistividad de piel y un pulsiox\u00edmetro con conexi\u00f3n I2C. Los datos recogidos por los sensores de transmiten v\u00eda bluetooth BLE, entre la ESP32 STEAMakers y la Raspberry Pi, a la aplicaci\u00f3n dise\u00f1ada en Node-RED para su tratamiento y almacenamiento en la base de datos SQLite. El dispositivo monitor de ponentes para ser autonomo se completa una alimentaci\u00f3n formada por un conversor DC/DC y una bater\u00eda lipo de 3.7V/1.100mAh.","title":"Monitorizaci\u00f3n Ponentes"},{"location":"monitorPonentes/programacion/","text":"","title":"Programa"},{"location":"monitorPonentes/pulsioximetro/","text":"Pulsiox\u00edmetro \u00b6 En contrucci\u00f3n El puls\u00f3metro y sensor de frecuencia card\u00edaca es un sensor biom\u00e9trico que funciona por I2C. Sensor pulsioximetro Utiliza dos chips de Maxim: El chip MAX30101 sensor puls\u00f3metro y frecuencia card\u00edaca . El MAX30101 realiza toda la detecci\u00f3n utilizando sus LED internos para hacer rebotar la luz en las arterias y arteriolas en la capa subcut\u00e1nea del dedo y detectar cu\u00e1nta luz se absorbe con sus fotodetectores, fotopletismograf\u00eda . Fotopletismograf\u00eda Estos datos se transmiten y analizan mediante el MAX32664, que aplica sus algoritmos para determinar la frecuencia card\u00edaca y la saturaci\u00f3n de ox\u00edgeno en sangre (SpO2). El chip biom\u00e9trico MAX32664. El chip MAX32664 es un procesador Cortex M4 que maneja todos los c\u00e1lculos algor\u00edtmicos, filtrado digital, compensaci\u00f3n de presi\u00f3n/posici\u00f3n, detecci\u00f3n avanzada de ondas R y control autom\u00e1tico de ganancia. [El sensor de pulso con ox\u00edmetro MAX30101/MAX32664] proporciona como resultados: El pulso. La saturaci\u00f3n de ox\u00edgeno en sangre (SpO2) mide la cantidad de ox\u00edgeno que puede transportar la sangre . La fiabilidad del sensor. Informa de la detecci\u00f3n del dedos. La placa dispone de una completa librer\u00eda para Arduino para facilitar el ajuste de todas las configuraciones posibles . M\u00e1s informaci\u00f3n en Bricogeek","title":"Pulsioximetro"},{"location":"monitorPonentes/pulsioximetro/#pulsioximetro","text":"En contrucci\u00f3n El puls\u00f3metro y sensor de frecuencia card\u00edaca es un sensor biom\u00e9trico que funciona por I2C. Sensor pulsioximetro Utiliza dos chips de Maxim: El chip MAX30101 sensor puls\u00f3metro y frecuencia card\u00edaca . El MAX30101 realiza toda la detecci\u00f3n utilizando sus LED internos para hacer rebotar la luz en las arterias y arteriolas en la capa subcut\u00e1nea del dedo y detectar cu\u00e1nta luz se absorbe con sus fotodetectores, fotopletismograf\u00eda . Fotopletismograf\u00eda Estos datos se transmiten y analizan mediante el MAX32664, que aplica sus algoritmos para determinar la frecuencia card\u00edaca y la saturaci\u00f3n de ox\u00edgeno en sangre (SpO2). El chip biom\u00e9trico MAX32664. El chip MAX32664 es un procesador Cortex M4 que maneja todos los c\u00e1lculos algor\u00edtmicos, filtrado digital, compensaci\u00f3n de presi\u00f3n/posici\u00f3n, detecci\u00f3n avanzada de ondas R y control autom\u00e1tico de ganancia. [El sensor de pulso con ox\u00edmetro MAX30101/MAX32664] proporciona como resultados: El pulso. La saturaci\u00f3n de ox\u00edgeno en sangre (SpO2) mide la cantidad de ox\u00edgeno que puede transportar la sangre . La fiabilidad del sensor. Informa de la detecci\u00f3n del dedos. La placa dispone de una completa librer\u00eda para Arduino para facilitar el ajuste de todas las configuraciones posibles . M\u00e1s informaci\u00f3n en Bricogeek","title":"Pulsiox\u00edmetro"},{"location":"monitorSala/BMP280/","text":"Sensor de presi\u00f3n BMP280 \u00b6 El sensor BMP280 mide la presi\u00f3n barom\u00e9trica absoluta de forma digital en el rango de 300 a 1100 hPa, con una precisi\u00f3n de \u00b1 1hPa. Permite la comunicaci\u00f3n I2C y SPI, aunque en nuestro caso utilizaremos I2C. El sensor tambi\u00e9n proporciona el valor de temperatura interna del m\u00f3dulo, aunque en nuestro caso no lo utilizaremos. La alimentaci\u00f3n del sensor va de 1,8V a 3,6V y tiene un consumo de 2,7\u00b5A para una lectura por segundo. Sensor BMP280 La configuraci\u00f3n del sensor BMP280 en el programa ESPEasy solo requiere la direcci\u00f3n del I2C. Los pines utilizados por el I2C se definen en el apartado de Hardware. Si le facilitamos la altura sobre el nivel del mar, la presi\u00f3n barom\u00e9trica, estar\u00e1 referenciada al nivel del mar y tambi\u00e9n podemos ajustar un offset para ajustar la lectura de la temperatura. En la configuraci\u00f3n de ESPEasy, aparece tambi\u00e9n la humedad, pero solo aplica cuando para el sensor BME280. En la figura siguiente se aprecia la configuraci\u00f3n requerida para dicho sensor en ESPEasy.","title":"BMP280"},{"location":"monitorSala/BMP280/#sensor-de-presion-bmp280","text":"El sensor BMP280 mide la presi\u00f3n barom\u00e9trica absoluta de forma digital en el rango de 300 a 1100 hPa, con una precisi\u00f3n de \u00b1 1hPa. Permite la comunicaci\u00f3n I2C y SPI, aunque en nuestro caso utilizaremos I2C. El sensor tambi\u00e9n proporciona el valor de temperatura interna del m\u00f3dulo, aunque en nuestro caso no lo utilizaremos. La alimentaci\u00f3n del sensor va de 1,8V a 3,6V y tiene un consumo de 2,7\u00b5A para una lectura por segundo. Sensor BMP280 La configuraci\u00f3n del sensor BMP280 en el programa ESPEasy solo requiere la direcci\u00f3n del I2C. Los pines utilizados por el I2C se definen en el apartado de Hardware. Si le facilitamos la altura sobre el nivel del mar, la presi\u00f3n barom\u00e9trica, estar\u00e1 referenciada al nivel del mar y tambi\u00e9n podemos ajustar un offset para ajustar la lectura de la temperatura. En la configuraci\u00f3n de ESPEasy, aparece tambi\u00e9n la humedad, pero solo aplica cuando para el sensor BME280. En la figura siguiente se aprecia la configuraci\u00f3n requerida para dicho sensor en ESPEasy.","title":"Sensor de presi\u00f3n BMP280"},{"location":"monitorSala/DHT22/","text":"Sensor temperatura y humedad DHT22 \u00b6 El sensor DHT22 es un dispositivo que permite la medida de la temperatura y la humedad relativa del aire. Se comunica a trav\u00e9s de un hilo, pero el protocolo es propio del DHT22 y permite la comunicaci\u00f3n a distancias de hasta 20 m. El rango de medida de temperatura va de -40\u00baC a 125\u00baC, con un error de \u00b1 0,5\u00baC y el rango de humedad es de 0 a 100%, con un error \u00b1 5%. La alimentaci\u00f3n est\u00e1 comprendida entre 3,3V y 6V, con un consumo de 1,5 mA en el ciclo de lectura y 50\u00b5A en reposo. El tiempo de lectura ser\u00e1 superior a los 2s. Sensor DHT22 La configuraci\u00f3n del sensor DHT22 en el programa ESPEasy solo requiere del numero de pin al que est\u00e1 conectado y el modelo del sensor. En la figura siguiente se aprecia la configuraci\u00f3n requerida para dicho sensor en ESPEasy. Configuraci\u00f3n sensor DHT22","title":"DHT22"},{"location":"monitorSala/DHT22/#sensor-temperatura-y-humedad-dht22","text":"El sensor DHT22 es un dispositivo que permite la medida de la temperatura y la humedad relativa del aire. Se comunica a trav\u00e9s de un hilo, pero el protocolo es propio del DHT22 y permite la comunicaci\u00f3n a distancias de hasta 20 m. El rango de medida de temperatura va de -40\u00baC a 125\u00baC, con un error de \u00b1 0,5\u00baC y el rango de humedad es de 0 a 100%, con un error \u00b1 5%. La alimentaci\u00f3n est\u00e1 comprendida entre 3,3V y 6V, con un consumo de 1,5 mA en el ciclo de lectura y 50\u00b5A en reposo. El tiempo de lectura ser\u00e1 superior a los 2s. Sensor DHT22 La configuraci\u00f3n del sensor DHT22 en el programa ESPEasy solo requiere del numero de pin al que est\u00e1 conectado y el modelo del sensor. En la figura siguiente se aprecia la configuraci\u00f3n requerida para dicho sensor en ESPEasy. Configuraci\u00f3n sensor DHT22","title":"Sensor temperatura y humedad DHT22"},{"location":"monitorSala/DS18B20/","text":"Sensor de temperatura DS18B20 \u00b6 El sensor DS18B20 es un term\u00f3metro digital que entrega medidas de temperatura con una resoluci\u00f3n de 9 a 12 bits. El dispositivo comunica con el microcontrolador por medio del protocolo 1 wire bus, ya que solo usa un hilo y masa. Cada dispositivo tiene grabado en memoria un c\u00f3digo \u00fanico de 64 bits, lo que permite conectar varios dispositivos en paralelo, utilizando el mismo hilo de comunicaci\u00f3n a trav\u00e9s de un recinto amplio. El tiempo de conversi\u00f3n de la temperatura depende de la resoluci\u00f3n y va de 94 ms para 9 bit a los 750 ms para 12 bit. El sensor se puede alimentar con una tensi\u00f3n entre 3 y 5V y puede medir temperaturas en el rango de -55\u00baC a 125\u00baC, con un error de \u00b1 0,5\u00baC en el rango de -10\u00baC a 85\u00baC. Sensor de temperatura DS18B20 No entraremos en detalle sobre el protocolo de comunicaci\u00f3n, ya que el programa ESPEasy, lo \u00fanico que requiere es saber el pin del microcontrolador al que se ha conectado, la resoluci\u00f3n de la medida y la direcci\u00f3n o c\u00f3digo del sensor. En nuestro caso utilizaremos el pin GPIO-16(D0) y una resoluci\u00f3n de 12 bits. ESPEasy nos permite leer por el mismo pin hasta 4 sensores y en nuestro caso nosotros utilizaremos solo 3. Hay que tener en cuenta que el c\u00f3digo del sensor lo desconocemos ya que dicha informaci\u00f3n no la suministra el vendedor y por lo tanto tendremos que conectar uno a uno los sensores y anotando el c\u00f3digo que lee el programa ESPEasy. En las figuras siguientes se puede ver la configuraci\u00f3n del dispositivo DS18B20 en el programa ESPEasy. Programando sensor de temperatura DS18B20 En este apartado le indicamos al programa el intervalo de lectura, el controlador ( en nuestro caso MQTT) por el que enviaremos los datos y las etiquetas de los valores que leeremos. Programando sensor de temperatura DS18B20","title":"DS18B20"},{"location":"monitorSala/DS18B20/#sensor-de-temperatura-ds18b20","text":"El sensor DS18B20 es un term\u00f3metro digital que entrega medidas de temperatura con una resoluci\u00f3n de 9 a 12 bits. El dispositivo comunica con el microcontrolador por medio del protocolo 1 wire bus, ya que solo usa un hilo y masa. Cada dispositivo tiene grabado en memoria un c\u00f3digo \u00fanico de 64 bits, lo que permite conectar varios dispositivos en paralelo, utilizando el mismo hilo de comunicaci\u00f3n a trav\u00e9s de un recinto amplio. El tiempo de conversi\u00f3n de la temperatura depende de la resoluci\u00f3n y va de 94 ms para 9 bit a los 750 ms para 12 bit. El sensor se puede alimentar con una tensi\u00f3n entre 3 y 5V y puede medir temperaturas en el rango de -55\u00baC a 125\u00baC, con un error de \u00b1 0,5\u00baC en el rango de -10\u00baC a 85\u00baC. Sensor de temperatura DS18B20 No entraremos en detalle sobre el protocolo de comunicaci\u00f3n, ya que el programa ESPEasy, lo \u00fanico que requiere es saber el pin del microcontrolador al que se ha conectado, la resoluci\u00f3n de la medida y la direcci\u00f3n o c\u00f3digo del sensor. En nuestro caso utilizaremos el pin GPIO-16(D0) y una resoluci\u00f3n de 12 bits. ESPEasy nos permite leer por el mismo pin hasta 4 sensores y en nuestro caso nosotros utilizaremos solo 3. Hay que tener en cuenta que el c\u00f3digo del sensor lo desconocemos ya que dicha informaci\u00f3n no la suministra el vendedor y por lo tanto tendremos que conectar uno a uno los sensores y anotando el c\u00f3digo que lee el programa ESPEasy. En las figuras siguientes se puede ver la configuraci\u00f3n del dispositivo DS18B20 en el programa ESPEasy. Programando sensor de temperatura DS18B20 En este apartado le indicamos al programa el intervalo de lectura, el controlador ( en nuestro caso MQTT) por el que enviaremos los datos y las etiquetas de los valores que leeremos. Programando sensor de temperatura DS18B20","title":"Sensor de temperatura DS18B20"},{"location":"monitorSala/ESP8266/","text":"ESP8266 \u00b6 Como se coment\u00f3 en el apartado anterior se eligi\u00f3 la placa basada en el microcontrolador ESP8266 por la flexibilidad que permite esta placa y por poder correr el programa ESPEasy. La placa utilizada es la NodeMCU Lua Lolin V3 Module ESP8266 ESP-12F WIFI, que tiene un coste de 7,5\u20ac. Controlador ESP8266 Las caracter\u00edsticas b\u00e1sicas son las siguientes: Fabricante Espressif Microcontrolador de 3,3 V Implementa el est\u00e1ndar WLAN 802.11b/n/g Soporta comunicaciones I2C/SPI/UART Antena de placa de circuito impresso integrada La placa viene con las tiras de pines sin soldar y por lo tanto hay que practicar con la soldadura. Para facilitar el conexionado, la placa ESP se mont\u00f3 sobre una placa de circuito impreso perforada, donde se realizaron todas las conexiones.","title":"ESP8266"},{"location":"monitorSala/ESP8266/#esp8266","text":"Como se coment\u00f3 en el apartado anterior se eligi\u00f3 la placa basada en el microcontrolador ESP8266 por la flexibilidad que permite esta placa y por poder correr el programa ESPEasy. La placa utilizada es la NodeMCU Lua Lolin V3 Module ESP8266 ESP-12F WIFI, que tiene un coste de 7,5\u20ac. Controlador ESP8266 Las caracter\u00edsticas b\u00e1sicas son las siguientes: Fabricante Espressif Microcontrolador de 3,3 V Implementa el est\u00e1ndar WLAN 802.11b/n/g Soporta comunicaciones I2C/SPI/UART Antena de placa de circuito impresso integrada La placa viene con las tiras de pines sin soldar y por lo tanto hay que practicar con la soldadura. Para facilitar el conexionado, la placa ESP se mont\u00f3 sobre una placa de circuito impreso perforada, donde se realizaron todas las conexiones.","title":"ESP8266"},{"location":"monitorSala/MH-Z19B/","text":"Sensor de CO2 HM-Z19B \u00b6 El HM-Z19B es un sensor que utiliza el principio NDIR (Non Dispersive Infrared) para detectar la presencia de CO2 en el aire. Dispone de sensor de temperatura incorporado para realizar la compensaci\u00f3n de temperatura. La salida de la medida se proporciona mediante un canal de comunicaci\u00f3n UART (9600, 8 bytes, 1 stop, no paridad), que es el que utilizaremos, aunque tambi\u00e9n dispone de salida PWM. El rango de medida es de 0 a 5000ppm con una precisi\u00f3n de \u00b1 50ppm y la alimentaci\u00f3n va de 3,6V a 5,5V, aunque la interface es a 3,3V. Sensor HM-Z19B Para leer este sensor en el programa ESPEasy, solo es necesario identificar los pines para la conexi\u00f3n UART y configurar el filtro y la auto calibraci\u00f3n. En la figura siguiente se puede apreciar la configuraci\u00f3n elegida para la lectura del HM-Z19B.","title":"MH-Z19B"},{"location":"monitorSala/MH-Z19B/#sensor-de-co2-hm-z19b","text":"El HM-Z19B es un sensor que utiliza el principio NDIR (Non Dispersive Infrared) para detectar la presencia de CO2 en el aire. Dispone de sensor de temperatura incorporado para realizar la compensaci\u00f3n de temperatura. La salida de la medida se proporciona mediante un canal de comunicaci\u00f3n UART (9600, 8 bytes, 1 stop, no paridad), que es el que utilizaremos, aunque tambi\u00e9n dispone de salida PWM. El rango de medida es de 0 a 5000ppm con una precisi\u00f3n de \u00b1 50ppm y la alimentaci\u00f3n va de 3,6V a 5,5V, aunque la interface es a 3,3V. Sensor HM-Z19B Para leer este sensor en el programa ESPEasy, solo es necesario identificar los pines para la conexi\u00f3n UART y configurar el filtro y la auto calibraci\u00f3n. En la figura siguiente se puede apreciar la configuraci\u00f3n elegida para la lectura del HM-Z19B.","title":"Sensor de CO2 HM-Z19B"},{"location":"monitorSala/ProgramacionESPEasy/","text":"Programacion con ESPEasy \u00b6 Como hemos comentado anteriormente, el coraz\u00f3n del dispositivo de monitorizaci\u00f3n de sala es el programa ESPEasy (Open Source), que se puede encontrar en: https://github.com/letscontrolit/ESPEasy La documentaci\u00f3n del programa se puede consultar aqu\u00ed: https://espeasy.readthedocs.io/en/latest/?badge=latest ESPEasy soporta una gran cantidad de sensores y visualizadores, v\u00eda plugins (Peque\u00f1a pieza de c\u00f3digo para comunicar con un dispositivo tal como un sensor). Existen varios builds (configuraciones de software), que pueden incluir diferentes plugins, seg\u00fan las necesidades. En esta p\u00e1gina: https://espeasy.readthedocs.io/en/latest/Plugin/_Plugin.html#list-of-official-plugins se pueden encontrar todos los dispositivos soportados por ESPEasy. Se puede apreciar que todos los sensores que se han utilizado en el proyecto est\u00e1n recogidos. En esta \u00faltima revisi\u00f3n, mayo 2022, el BMP280 ha sido retirado y aunque no se incluye en ninguno de los builds, el c\u00f3digo fuente est\u00e1 disponible. ESPEasy permite conectar hasta 12 dispositivos y los datos de esos dispositivos se pueden enviar a trav\u00e9s de hasta 3 controladores. En nuestro proyecto hemos incluido un dispositivo gen\u00e9rico con informaci\u00f3n del sistema y lo hemos configurado para que nos env\u00ede el nivel de se\u00f1al (RSSI) de la WiFi, la carga del sistema y el tiempo en funcionamiento desde el \u00faltimo encendido. Aparte de los dispositivos, en ESPEasy existen plugins para los controladores, que son los encargados de enviar los datos y en esta p\u00e1gina, se encuentran todos los controladores disponibles. https://espeasy.readthedocs.io/en/latest/Controller/_Controller.html ESPEasy permite instalar hasta 3 controladores. En nuestro caso hemos utilizado el controlador \u201cHome Assistant (openHAB) MQTT\u201d, ya que nos comunicaremos con la unidad de monitorizaci\u00f3n por el protocolo MQTT. La configuraci\u00f3n de este controlador es la siguiente: Tambi\u00e9n existe una configuraci\u00f3n para el equipo, en la que se incluyen datos de los pines utilizados para I2C, SPI, si se utiliza un pin para un LED, o si se utiliza un pin para realizar el reset. Tambi\u00e9n permite configurar el estado de los pines en el arranque. En nuestro proyecto realizamos un build a medida a trav\u00e9s de Platformio y VS Code, pero eso da para un taller entero y no lo trataremos aqu\u00ed.","title":"Programaci\u00f3n con ESPEasy"},{"location":"monitorSala/ProgramacionESPEasy/#programacion-con-espeasy","text":"Como hemos comentado anteriormente, el coraz\u00f3n del dispositivo de monitorizaci\u00f3n de sala es el programa ESPEasy (Open Source), que se puede encontrar en: https://github.com/letscontrolit/ESPEasy La documentaci\u00f3n del programa se puede consultar aqu\u00ed: https://espeasy.readthedocs.io/en/latest/?badge=latest ESPEasy soporta una gran cantidad de sensores y visualizadores, v\u00eda plugins (Peque\u00f1a pieza de c\u00f3digo para comunicar con un dispositivo tal como un sensor). Existen varios builds (configuraciones de software), que pueden incluir diferentes plugins, seg\u00fan las necesidades. En esta p\u00e1gina: https://espeasy.readthedocs.io/en/latest/Plugin/_Plugin.html#list-of-official-plugins se pueden encontrar todos los dispositivos soportados por ESPEasy. Se puede apreciar que todos los sensores que se han utilizado en el proyecto est\u00e1n recogidos. En esta \u00faltima revisi\u00f3n, mayo 2022, el BMP280 ha sido retirado y aunque no se incluye en ninguno de los builds, el c\u00f3digo fuente est\u00e1 disponible. ESPEasy permite conectar hasta 12 dispositivos y los datos de esos dispositivos se pueden enviar a trav\u00e9s de hasta 3 controladores. En nuestro proyecto hemos incluido un dispositivo gen\u00e9rico con informaci\u00f3n del sistema y lo hemos configurado para que nos env\u00ede el nivel de se\u00f1al (RSSI) de la WiFi, la carga del sistema y el tiempo en funcionamiento desde el \u00faltimo encendido. Aparte de los dispositivos, en ESPEasy existen plugins para los controladores, que son los encargados de enviar los datos y en esta p\u00e1gina, se encuentran todos los controladores disponibles. https://espeasy.readthedocs.io/en/latest/Controller/_Controller.html ESPEasy permite instalar hasta 3 controladores. En nuestro caso hemos utilizado el controlador \u201cHome Assistant (openHAB) MQTT\u201d, ya que nos comunicaremos con la unidad de monitorizaci\u00f3n por el protocolo MQTT. La configuraci\u00f3n de este controlador es la siguiente: Tambi\u00e9n existe una configuraci\u00f3n para el equipo, en la que se incluyen datos de los pines utilizados para I2C, SPI, si se utiliza un pin para un LED, o si se utiliza un pin para realizar el reset. Tambi\u00e9n permite configurar el estado de los pines en el arranque. En nuestro proyecto realizamos un build a medida a trav\u00e9s de Platformio y VS Code, pero eso da para un taller entero y no lo trataremos aqu\u00ed.","title":"Programacion con ESPEasy"},{"location":"monitorSala/introduccion/","text":"Introducci\u00f3n \u00b6 Unas de las premisas de la organizaci\u00f3n era la de monitorizar el ambiente de la sala del teatro Isabel la Cat\u00f3lica en tiempo real y analizar el comportamiento del sistema de climatizaci\u00f3n y ventilaci\u00f3n en presencia de espectadores. Dada la magnitud de la sala hubiera sido necesario utilizar una gran cantidad de sensores, pero dadas las limitaciones, se opt\u00f3 por medir la temperatura a cuatro alturas distintas, la humedad relativa el porcentaje de CO2 y la presi\u00f3n atmosf\u00e9rica. Con la medida de la temperatura en cuatro alturas, se pretend\u00eda comprobar la estratificaci\u00f3n del aire en la sala y ver el comportamiento del sistema de climatizaci\u00f3n y ventilaci\u00f3n del teatro. La medida de la humedad nos dar\u00eda una idea de como afecta la respiraci\u00f3n del p\u00fablico y c\u00f3mo responde el sistema de climatizaci\u00f3n. Otra magnitud a medir era la concentraci\u00f3n de CO2 en el aire, y ver la eficiencia del sistema de ventilaci\u00f3n. La medida de la presi\u00f3n atmosf\u00e9rica no ten\u00eda relevancia en la monitorizaci\u00f3n de la sala, pero se decidi\u00f3 incluirla con fines did\u00e1cticos. Esta medida de la presi\u00f3n se podr\u00eda usar para calcular las variables psicom\u00e9tricas del aire de la sala, pero se opt\u00f3 por medir y representar el valor. La instrumentaci\u00f3n que se eligi\u00f3 estaba formada por: 3 sensores de temperatura con vaina y 3 metros de longitud, del tipo DS18B20. 1 sensor DHT22 para la medida de la cuarta temperatura y la humedad relativa. 1 sensor de concentraci\u00f3n de CO2 del tipo MH-Z19B. 1 sensor de presi\u00f3n atmosf\u00e9rica del tipo BMP280. En la figura siguiente se puede apreciar la ubicaci\u00f3n de los sensores. Ubicaci\u00f3n de los sensores en el teatro Quedaba entonces elegir que plataforma utilizar para leer los datos de todos los sensores y enviar la informaci\u00f3n a la unidad de visualizaci\u00f3n. Despu\u00e9s de analizar las opciones, se decidi\u00f3 utilizar una placa con procesador ESP8266, en concreto la placa NodeMCU Lua Lolin V3 Module ESP8266 ESP-12F WIFI. A continuaci\u00f3n, se muestra el conexionado de la placa y el montaje del conjunto. Esquema conexionado Sistema monitorizacion sala Por \u00faltimo, hab\u00eda que elegir como programar la placa ESP y se decidi\u00f3 utilizar el programa ESPEasy, que permite trabajar con una gran cantidad de sensores y en concreto tiene soporte para los sensores elegidos, sin necesidad de programar c\u00f3digo. Toda la configuraci\u00f3n se realiza v\u00eda Web. La comunicaci\u00f3n entre la placa de los sensores y la unidad de visualizaci\u00f3n se realiz\u00f3 mediante la red WiFi, utilizando el protocolo MQTT, integrado en el software ESPEasy. Para no depender de la red del teatro, se cre\u00f3 una red propia para la monitorizaci\u00f3n, utilizando un router inal\u00e1mbrico. En la figura siguiente se muestra la arquitectura utilizada. Sistema monitorizacion sala y ponentes Quedaba elegir la alimentaci\u00f3n de la placa y dado que no se dispon\u00eda de tomas de corriente en la ubicaci\u00f3n de la placa, se opt\u00f3 por utilizar una power bank de 5V, con autonom\u00eda suficiente para la duraci\u00f3n del evento. En los apartados siguientes analizaremos uno a uno los componentes de la unidad de monitorizaci\u00f3n de sala.","title":"Introduccion"},{"location":"monitorSala/introduccion/#introduccion","text":"Unas de las premisas de la organizaci\u00f3n era la de monitorizar el ambiente de la sala del teatro Isabel la Cat\u00f3lica en tiempo real y analizar el comportamiento del sistema de climatizaci\u00f3n y ventilaci\u00f3n en presencia de espectadores. Dada la magnitud de la sala hubiera sido necesario utilizar una gran cantidad de sensores, pero dadas las limitaciones, se opt\u00f3 por medir la temperatura a cuatro alturas distintas, la humedad relativa el porcentaje de CO2 y la presi\u00f3n atmosf\u00e9rica. Con la medida de la temperatura en cuatro alturas, se pretend\u00eda comprobar la estratificaci\u00f3n del aire en la sala y ver el comportamiento del sistema de climatizaci\u00f3n y ventilaci\u00f3n del teatro. La medida de la humedad nos dar\u00eda una idea de como afecta la respiraci\u00f3n del p\u00fablico y c\u00f3mo responde el sistema de climatizaci\u00f3n. Otra magnitud a medir era la concentraci\u00f3n de CO2 en el aire, y ver la eficiencia del sistema de ventilaci\u00f3n. La medida de la presi\u00f3n atmosf\u00e9rica no ten\u00eda relevancia en la monitorizaci\u00f3n de la sala, pero se decidi\u00f3 incluirla con fines did\u00e1cticos. Esta medida de la presi\u00f3n se podr\u00eda usar para calcular las variables psicom\u00e9tricas del aire de la sala, pero se opt\u00f3 por medir y representar el valor. La instrumentaci\u00f3n que se eligi\u00f3 estaba formada por: 3 sensores de temperatura con vaina y 3 metros de longitud, del tipo DS18B20. 1 sensor DHT22 para la medida de la cuarta temperatura y la humedad relativa. 1 sensor de concentraci\u00f3n de CO2 del tipo MH-Z19B. 1 sensor de presi\u00f3n atmosf\u00e9rica del tipo BMP280. En la figura siguiente se puede apreciar la ubicaci\u00f3n de los sensores. Ubicaci\u00f3n de los sensores en el teatro Quedaba entonces elegir que plataforma utilizar para leer los datos de todos los sensores y enviar la informaci\u00f3n a la unidad de visualizaci\u00f3n. Despu\u00e9s de analizar las opciones, se decidi\u00f3 utilizar una placa con procesador ESP8266, en concreto la placa NodeMCU Lua Lolin V3 Module ESP8266 ESP-12F WIFI. A continuaci\u00f3n, se muestra el conexionado de la placa y el montaje del conjunto. Esquema conexionado Sistema monitorizacion sala Por \u00faltimo, hab\u00eda que elegir como programar la placa ESP y se decidi\u00f3 utilizar el programa ESPEasy, que permite trabajar con una gran cantidad de sensores y en concreto tiene soporte para los sensores elegidos, sin necesidad de programar c\u00f3digo. Toda la configuraci\u00f3n se realiza v\u00eda Web. La comunicaci\u00f3n entre la placa de los sensores y la unidad de visualizaci\u00f3n se realiz\u00f3 mediante la red WiFi, utilizando el protocolo MQTT, integrado en el software ESPEasy. Para no depender de la red del teatro, se cre\u00f3 una red propia para la monitorizaci\u00f3n, utilizando un router inal\u00e1mbrico. En la figura siguiente se muestra la arquitectura utilizada. Sistema monitorizacion sala y ponentes Quedaba elegir la alimentaci\u00f3n de la placa y dado que no se dispon\u00eda de tomas de corriente en la ubicaci\u00f3n de la placa, se opt\u00f3 por utilizar una power bank de 5V, con autonom\u00eda suficiente para la duraci\u00f3n del evento. En los apartados siguientes analizaremos uno a uno los componentes de la unidad de monitorizaci\u00f3n de sala.","title":"Introducci\u00f3n"}]}